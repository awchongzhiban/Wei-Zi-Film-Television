{"version":3,"sources":["webpack://DanmuJs/webpack/bootstrap","webpack://DanmuJs/./src/utils/util.js","webpack://DanmuJs/./src/baseClass.js","webpack://DanmuJs/./node_modules/es5-ext/object/is-value.js","webpack://DanmuJs/./node_modules/type/value/is.js","webpack://DanmuJs/./src/utils/logger.js","webpack://DanmuJs/./src/index.js","webpack://DanmuJs/./src/danmu.js","webpack://DanmuJs/./node_modules/event-emitter/index.js","webpack://DanmuJs/./node_modules/d/index.js","webpack://DanmuJs/./node_modules/type/plain-function/is.js","webpack://DanmuJs/./node_modules/type/function/is.js","webpack://DanmuJs/./node_modules/type/prototype/is.js","webpack://DanmuJs/./node_modules/type/object/is.js","webpack://DanmuJs/./node_modules/es5-ext/object/assign/index.js","webpack://DanmuJs/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://DanmuJs/./node_modules/es5-ext/object/assign/shim.js","webpack://DanmuJs/./node_modules/es5-ext/object/keys/index.js","webpack://DanmuJs/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://DanmuJs/./node_modules/es5-ext/object/keys/shim.js","webpack://DanmuJs/./node_modules/es5-ext/function/noop.js","webpack://DanmuJs/./node_modules/es5-ext/object/valid-value.js","webpack://DanmuJs/./node_modules/es5-ext/object/normalize-options.js","webpack://DanmuJs/./node_modules/es5-ext/string/#/contains/index.js","webpack://DanmuJs/./node_modules/es5-ext/string/#/contains/is-implemented.js","webpack://DanmuJs/./node_modules/es5-ext/string/#/contains/shim.js","webpack://DanmuJs/./node_modules/es5-ext/object/valid-callable.js","webpack://DanmuJs/./src/control.js","webpack://DanmuJs/./src/main.js","webpack://DanmuJs/./src/bullet.js","webpack://DanmuJs/./src/channel.js","webpack://DanmuJs/./src/utils/validator.js","webpack://DanmuJs/./src/domRecycle.js","webpack://DanmuJs/./src/resizeObserver.js","webpack://DanmuJs/./src/style/index.scss?2278","webpack://DanmuJs/./src/style/index.scss","webpack://DanmuJs/./node_modules/css-loader/lib/css-base.js","webpack://DanmuJs/./node_modules/style-loader/lib/addStyles.js","webpack://DanmuJs/./node_modules/style-loader/lib/urls.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","createDom","el","tpl","attrs","cname","dom","document","createElement","className","innerHTML","keys","forEach","item","setAttribute","hasClass","addClass","removeClass","toggleClass","split","findDom","sel","querySelector","e","startsWith","getElementById","slice","deepCopy","dst","src","typeOf","Node","concat","copyDom","nodeType","back","tagName","Array","attributes","node","attachEventListener","event","fn","offEvent","on","once","onDestroy","off","offInDestroy","_fn","data","styleUtil","elem","style","error","setProperty","styleCSSText","cssText","isNumber","val","Number","isNaN","isFunction","throttle","func","wait","timer","args","clearTimeout","setTimeout","apply","classList","some","match","RegExp","replace","add","remove","reg","obj","toString","BaseClass","logger","this","Log","_undefined","DEBUG","window","location","href","indexOf","Logger","constructorName","message","optionalParams","console","log","DanmuJs","options","setLogger","info","version","config","overlap","area","start","end","lines","undefined","hooks","live","comments","direction","needResizeObserver","dropStaleComments","channelSize","maxCommentsLength","bulletOffset","interval","highScorePriority","chaseEffect","globalHooks","hideArr","recycler","RecyclableDomList","freezeId","comment","duration","container","emit","containerStyle","player","bulletBtn","Control","main","isReady","addResizeObserver","addObserver","resize","pause","play","stop","clear","k","unObserver","destroy","txt","id","elLazyInit","opacity","fontSize","prior","realTime","unshift","readData","dataHandle","push","sortData","keepPoolWatermark","oldID","newID","queue","pauseMove","status","startMove","like","setLikeDom","danmu","_releaseCtrl","mouseControl","_freezeCtrl","filter","isClear","length","force","forceDuration","playRate","size","reflow","setFontSize","top","channel_id","topInit","channel","resizeSync","arr","color","index","splice","bullets","displayArea","getRealOccupyArea","containerPos","methods","descriptors","base","callable","Function","defineProperties","descriptor","configurable","writable","type","listener","self","arguments","__eeOnceListener__","__ee__","listeners","candidate","isValue","isPlainFunction","assign","normalizeOpts","contains","dscr","w","desc","gs","set","classRe","functionToString","test","isPrototype","isObject","constructor","possibleTypes","foo","bar","trzy","max","Math","dest","TypeError","process","opts1","result","String","str","searchString","Main","defaultOff","state","switchBtn","Channel","playedData","retryStatus","_status","_events","_bindEvents","_unbindEvents","_cancelTick","bullet","attached_","_getBulletByEvt","mouseEnterControl","mouseControlPause","addEventListener","removeEventListener","handleTimer","reset","_startTick","channels","resized","list","currentTime","floor","sort","prev","cur","score","checkAvailableTrack","updatePos","tryCount","ListLoop","Bullet","bulletCreateFail","attach","addBullet","detach","noDiscard","priorComments","deleteCount","timePoint","target","srcElement","bookChannelId","reuseDOM","noCopyEl","disableCopyDOM","_fullySlideInScreenDuration","_lastMoveTime","_makeEl","bulletCreateEl","HTMLElement","parentNode","copyDOM","eventListeners","eventListener","useCapture","use","childNodes","textContent","appendChild","offset","width","random","left","updateOffset","bbqKey","toLowerCase","dryRun","bulletAttaching","elPos","getBoundingClientRect","height","moveV","bulletAttached","bulletDetaching","unused","removeChild","bulletDetached","isFullscreen","_moveV","ctPos","pastDuration","Date","getTime","pastS","nowS","moveMoreS","moveContainerHeight","moveContainerWidth","startTime","hasMove","bulletPos","fullyMovedToScreenDistance","bottom","leftDuration","right","leftDistance","newTimestamp","needPause","children","outerHTML","v","flag","removeBullet","operating","curBullet","fullySlideIntoScreen","_cancelResizeTimer","isInit","channelReset","resetId","cancelAnimationFrame","_initChannels","channelCount","channelWidth","channelHeight","requestAnimationFrame","pos","containerWidth","containerHeight","containerTop","containerBottom","containerLeft","containerRight","occupy","ceil","j","scroll","bookId","curBulletPos","curS","curV","curT","newV","catchS","catchT","bOffset","deleteIndex","deleteItem","nextAddTime","channelId","loop","navigator","userAgent","validAreaLineRule","modulus","sync","setItem","updateChannelsLower","updateTopScrollQueue","key_","updateBottomQueue","updateChannelsGreater","items","num","layout","resizing","resizeId","line","isInteger","RecyclableDOMList","initDOM","initSize","init","idleList","usingList","_id","_expand","firseIdle","shift","idx","textcontent","clearElementStyle","element","ua","resizeObserver","__handlers","ResizeObserver","observer","entries","__trigger","err","handler","observe","map","unobserve","disconnect","__runHandler","destroyObserver","content","transform","locals","useSourceMap","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","memo","stylesInDom","isOldIE","all","atob","getTarget","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","parts","addStyle","listToStyles","newStyles","part","css","media","insertStyleElement","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","firstChild","before","removeStyleElement","createStyleElement","addAttrs","update","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","applyToTag","newObj","newList","mayRemove","textStore","replaceText","replacement","Boolean","styleSheet","cssNode","createTextNode","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","export const hasOwnProperty = Object.prototype.hasOwnProperty\n\nexport function createDom(el = 'div', tpl = '', attrs = {}, cname = '') {\n  const dom = document.createElement(el)\n  dom.className = cname\n  dom.innerHTML = tpl\n  Object.keys(attrs).forEach((item) => {\n    const key = item\n    const value = attrs[item]\n    if (el === 'video' || el === 'audio') {\n      if (value) {\n        dom.setAttribute(key, value)\n      }\n    } else {\n      dom.setAttribute(key, value)\n    }\n  })\n  return dom\n}\n\nexport function hasClass(el, className) {\n  if (el.classList) {\n    return Array.prototype.some.call(el.classList, (item) => item === className)\n  } else {\n    return !!el.className.match(new RegExp('(\\\\s|^)' + className + '(\\\\s|$)'))\n  }\n}\n\nexport function addClass(el, className) {\n  if (el.classList) {\n    className\n      .replace(/(^\\s+|\\s+$)/g, '')\n      .split(/\\s+/g)\n      .forEach((item) => {\n        item && el.classList.add(item)\n      })\n  } else if (!hasClass(el, className)) {\n    el.className += ' ' + className\n  }\n}\n\nexport function removeClass(el, className) {\n  if (el.classList) {\n    className.split(/\\s+/g).forEach((item) => {\n      el.classList.remove(item)\n    })\n  } else if (hasClass(el, className)) {\n    className.split(/\\s+/g).forEach((item) => {\n      const reg = new RegExp('(\\\\s|^)' + item + '(\\\\s|$)')\n      el.className = el.className.replace(reg, ' ')\n    })\n  }\n}\n\nexport function toggleClass(el, className) {\n  className.split(/\\s+/g).forEach((item) => {\n    if (hasClass(el, item)) {\n      removeClass(el, item)\n    } else {\n      addClass(el, item)\n    }\n  })\n}\n\nexport function findDom(el = document, sel) {\n  let dom\n  // fix querySelector IDs that start with a digit\n  // https://stackoverflow.com/questions/37270787/uncaught-syntaxerror-failed-to-execute-queryselector-on-document\n  try {\n    dom = el.querySelector(sel)\n  } catch (e) {\n    if (sel.startsWith('#')) {\n      dom = el.getElementById(sel.slice(1))\n    }\n  }\n  return dom\n}\n\nexport function deepCopy(dst, src) {\n  if (typeOf(src) === 'Object' && typeOf(dst) === 'Object') {\n    Object.keys(src).forEach((key) => {\n      if (typeOf(src[key]) === 'Object' && !(src[key] instanceof Node)) {\n        if (!dst[key]) {\n          dst[key] = src[key]\n        } else {\n          deepCopy(dst[key], src[key])\n        }\n      } else if (typeOf(src[key]) === 'Array') {\n        dst[key] = typeOf(dst[key]) === 'Array' ? dst[key].concat(src[key]) : src[key]\n      } else {\n        dst[key] = src[key]\n      }\n    })\n    return dst\n  }\n}\n\nexport function typeOf(obj) {\n  return Object.prototype.toString.call(obj).match(/([^\\s.*]+)(?=]$)/g)[0]\n}\n\nexport function copyDom(dom) {\n  if (dom && dom.nodeType === 1) {\n    const back = document.createElement(dom.tagName)\n    Array.prototype.forEach.call(dom.attributes, (node) => {\n      back.setAttribute(node.name, node.value)\n    })\n    if (dom.innerHTML) {\n      back.innerHTML = dom.innerHTML\n    }\n    return back\n  } else {\n    return ''\n  }\n}\n\nfunction offInDestroy(object, event, fn, offEvent) {\n  function onDestroy() {\n    object.off(event, fn)\n    object.off(offEvent, onDestroy)\n  }\n  object.once(offEvent, onDestroy)\n}\n\nexport function attachEventListener(object, event, fn, offEvent) {\n  if (offEvent) {\n    object.on(event, fn)\n    offInDestroy(object, event, fn, offEvent)\n  } else {\n    const _fn = (data) => {\n      fn(data)\n      object.off(event, _fn)\n    }\n    object.on(event, _fn)\n  }\n}\n\n/**\n * @param {HTMLElement} elem\n * @param {string} name\n * @param {string} value\n */\nexport function styleUtil(elem, name, value) {\n  const style = elem.style\n  try {\n    style[name] = value\n  } catch (error) {\n    style.setProperty(name, value)\n  }\n}\n\n/**\n * @param {HTMLElement} elem\n * @param {string} value\n */\nexport function styleCSSText(elem, value) {\n  const style = elem.style\n  try {\n    style.cssText = value\n  } catch (error) {}\n}\n\nexport function isNumber(val) {\n  return typeof val === 'number' && !Number.isNaN(val)\n}\n\nexport function isFunction(val) {\n  return typeof val === 'function'\n}\n\n/**\n * Simple throttle\n * @param {() => void} func\n * @param {number} wait\n * @returns\n */\nexport function throttle(func, wait) {\n  let timer = 0\n  return (...args) => {\n    clearTimeout(timer)\n    timer = setTimeout(() => func.apply(this, args), wait)\n  }\n}\n","import Log from './utils/logger'\n\nclass BaseClass {\n  setLogger(logger) {\n    this.logger = logger instanceof Log ? logger : new Log((logger || '') + '.js')\n  }\n}\n\nexport default BaseClass\n\n/**\n * @typedef {{\n *  id: string\n *  start: number\n *  duration: number\n *  prior: boolean\n *  score?: number // 积分越高，越容易展示\n *  txt?: string\n *  el?: HTMLElement | Function\n *  elLazyInit?: boolean // 配置了elLazyInit后，则通过hooks提供的时机进行el创建，该方式可减少dom数量\n *  mode: 'scroll' | 'top' | 'bottom'\n *  attached_: boolean // 内部属性，标记弹幕是否已经被入轨\n *  realTime?: boolean,\n *  color?: string,\n *  bookChannelId?: [number, any]\n * }} CommentData\n */\n\n/**\n * @typedef {{\n *  bulletCreateEl?: (item: CommentData) => HTMLElement | {\n *      el: HTMLElement\n *  } & GlobalHooks\n *  bulletAttaching?: (item: CommentData) => void\n *  bulletAttached?: (item: CommentData) => void\n *  bulletDetaching?: (item: CommentData) => void\n *  bulletDetached?: (item: CommentData, HTMLElement) => void\n * }} GlobalHooks\n */\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","const DEBUG = typeof window !== 'undefined' && window.location.href.indexOf('danmu-debug') > -1\n\nclass Logger {\n  constructor(constructorName) {\n    this.constructorName = constructorName || ''\n  }\n  info(message, ...optionalParams) {\n    DEBUG && console.log(`[Danmu Log][${this.constructorName}]`, message, ...optionalParams)\n  }\n}\n\nexport default Logger\n","import DanmuJs from './danmu'\nimport './style/index.scss'\n\nexport default DanmuJs\n","import EventEmitter from 'event-emitter'\nimport { version } from '../version.json'\nimport BaseClass from './baseClass'\nimport Control from './control'\nimport RecyclableDomList from './domRecycle'\nimport { addObserver, unObserver } from './resizeObserver'\nimport { addClass, deepCopy, isNumber, styleUtil } from './utils/util'\n\n/**\n * @typedef {import('./baseClass').CommentData} CommentData\n */\n/**\n * @typedef {import('./baseClass').GlobalHooks} GlobalHooks\n */\n\nexport class DanmuJs extends BaseClass {\n  constructor(options) {\n    super()\n\n    // logger\n    this.setLogger('danmu')\n    this.logger && this.logger.info(`danmu.js version: ${version}`)\n\n    // configure\n    const config = (this.config = {\n      overlap: false,\n      area: {\n        start: 0,\n        end: 1,\n        lines: undefined\n      },\n      hooks: undefined,\n      live: false,\n      comments: [],\n      direction: 'r2l',\n      needResizeObserver: false,\n      dropStaleComments: false,\n      channelSize: undefined,\n      maxCommentsLength: undefined,\n      bulletOffset: undefined,\n      interval: 2000,\n      highScorePriority: true, // 高积分优先展示\n      chaseEffect: true // 滚动弹幕追逐效果\n    })\n    deepCopy(config, options)\n\n    // Add event subscription handler\n    EventEmitter(this)\n\n    /**\n     * @type {GlobalHooks}\n     */\n    this.globalHooks = {}\n    if (config.hooks) {\n      this.hooks(config.hooks)\n    }\n\n    this.hideArr = []\n    this.recycler = new RecyclableDomList()\n\n    // freezed comment\n    this.freezeId = null\n\n    config.comments.forEach((comment) => {\n      comment.duration = comment.duration ? comment.duration : 5000\n      if (!comment.mode) {\n        comment.mode = 'scroll'\n      }\n    })\n\n    /**\n     * @type {HTMLElement}\n     */\n    this.container = config.container && config.container.nodeType === 1 ? config.container : null\n    if (!this.container) {\n      // eslint-disable-next-line quotes\n      this.emit('error', \"container id can't be empty\")\n      return false\n    }\n    if (config.containerStyle) {\n      const style = config.containerStyle\n      Object.keys(style).forEach((key) => {\n        this.container.style[key] = style[key]\n      })\n    }\n    addClass(this.container, 'danmu')\n    this.live = config.live\n    this.player = config.player\n    this.direction = config.direction\n    this.bulletBtn = new Control(this)\n    this.main = this.bulletBtn.main\n    this.isReady = true\n    this.emit('ready')\n    this.logger && this.logger.info('ready')\n    this.addResizeObserver()\n  }\n\n  get status() {\n    return this.main.status\n  }\n\n  get state() {\n    const main = this.main\n    return {\n      status: main.status,\n      comments: main.data,\n      bullets: main.queue,\n      displayArea: main.channel.getRealOccupyArea()\n    }\n  }\n\n  get containerPos() {\n    return this.main.channel.containerPos\n  }\n\n  /**\n   * @param {GlobalHooks} options\n   */\n  hooks(options) {\n    deepCopy(this.globalHooks, options)\n  }\n\n  addResizeObserver() {\n    if (this.config.needResizeObserver && this.container) {\n      addObserver(this.container, () => {\n        this.logger && this.logger.info('needResizeObserver')\n        this.resize()\n      })\n    }\n  }\n\n  start() {\n    this.logger && this.logger.info('start')\n    this.main && this.main.start()\n  }\n\n  pause() {\n    this.logger && this.logger.info('pause')\n    this.main && this.main.pause()\n  }\n\n  play() {\n    this.logger && this.logger.info('play')\n    this.main && this.main.play()\n  }\n\n  stop() {\n    this.logger && this.logger.info('stop')\n    this.main && this.main.stop()\n  }\n\n  clear() {\n    this.logger && this.logger.info('clear')\n    this.main && this.main.clear()\n  }\n\n  destroy() {\n    unObserver(this.container)\n    this.logger && this.logger.info('destroy')\n    this.stop()\n    this.bulletBtn && this.bulletBtn.destroy()\n    this.recycler && this.recycler.destroy()\n    for (let k in this) {\n      delete this[k]\n    }\n    this.emit('destroy')\n  }\n\n  /**\n   * @param {CommentData} comment\n   */\n  sendComment(comment) {\n    const { main, logger } = this\n    logger && logger.info(`sendComment: ${comment.txt || '[DOM Element]'}`)\n\n    if (!main) return\n\n    // Set a default bullet show time\n    if (!comment.duration) {\n      comment.duration = 15000\n    }\n\n    if (comment && comment.id && comment.duration && (comment.el || comment.elLazyInit || comment.txt)) {\n      comment.duration = comment.duration ? comment.duration : 5000\n      if (!comment.style) {\n        comment.style = {\n          opacity: undefined,\n          fontSize: undefined\n        }\n      }\n      if (comment.style) {\n        if (this.opacity && this.opacity !== comment.style.opacity) {\n          comment.style.opacity = this.opacity\n        }\n        if (this.fontSize && this.fontSize !== comment.style.fontSize) {\n          comment.style.fontSize = this.fontSize\n        }\n      }\n      if (comment.prior || comment.realTime) {\n        main.data.unshift(comment)\n        if (comment.realTime) {\n          main.readData()\n          main.dataHandle()\n        }\n      } else {\n        main.data.push(comment)\n      }\n\n      main.sortData()\n      main.keepPoolWatermark()\n    }\n  }\n\n  setCommentID(oldID, newID) {\n    this.logger && this.logger.info(`setCommentID: oldID ${oldID} newID ${newID}`)\n    if (oldID && newID) {\n      this.main.data.some((data) => {\n        if (data.id === oldID) {\n          data.id = newID\n          return true\n        } else {\n          return false\n        }\n      })\n      this.main.queue.some((item) => {\n        if (item.id === oldID) {\n          item.id = newID\n          item.pauseMove()\n          this.main.status !== 'paused' && item.startMove()\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  setCommentDuration(id, duration) {\n    this.logger && this.logger.info(`setCommentDuration: id ${id} duration ${duration}`)\n\n    if (id && duration) {\n      duration = duration ? duration : 5000\n      this.main.data.some((data) => {\n        if (data.id === id) {\n          data.duration = duration\n          return true\n        } else {\n          return false\n        }\n      })\n      this.main.queue.some((item) => {\n        if (item.id === id) {\n          item.duration = duration\n          item.pauseMove()\n          this.main.status !== 'paused' && item.startMove()\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  setCommentLike(id, like) {\n    this.logger && this.logger.info(`setCommentLike: id ${id} like ${like}`)\n    if (id && like) {\n      this.main.data.some((data) => {\n        if (data.id === id) {\n          data.like = like\n          return true\n        } else {\n          return false\n        }\n      })\n      this.main.queue.some((item) => {\n        if (item.id === id) {\n          item.pauseMove()\n          item.setLikeDom(like.el, like.style)\n          if (item.danmu.main.status !== 'paused') {\n            item.startMove()\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  restartComment(id) {\n    this.logger && this.logger.info(`restartComment: id ${id}`)\n\n    if (id) {\n      const self = this\n      const main = self.main\n\n      self._releaseCtrl(id)\n\n      if (main.status === 'closed') {\n        // The main process has been stopped, there is no need to drive the barrage to run\n        return\n      }\n\n      main.queue.some((item) => {\n        if (item.id === id) {\n          if (main.status !== 'paused') {\n            item.startMove(true)\n          } else {\n            item.status = 'paused'\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  /**\n   * @private\n   */\n  _releaseCtrl(id) {\n    const self = this\n\n    if (self.freezeId && id === self.freezeId) {\n      self.mouseControl = false\n      self.freezeId = null\n    }\n  }\n\n  /**\n   * @private\n   */\n  _freezeCtrl(id) {\n    this.mouseControl = true\n    this.freezeId = id\n  }\n\n  freezeComment(id) {\n    this.logger && this.logger.info(`freezeComment: id ${id}`)\n\n    if (id) {\n      const self = this\n\n      self._freezeCtrl(id)\n\n      self.main.queue.some((item) => {\n        if (item.id === id) {\n          item.status = 'forcedPause'\n          item.pauseMove()\n          if (item.el && item.el.style) {\n            styleUtil(item.el, 'zIndex', 10)\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  removeComment(id) {\n    this.logger && this.logger.info(`removeComment: id ${id}`)\n\n    if (id) {\n      const self = this\n      const { main } = self\n      \n      self._releaseCtrl(id)\n\n      // remove bullet from the queue list\n      main.queue = main.queue.filter((item) => {\n        if (item.id === id) {\n          item.remove()\n          return false\n        } else {\n          return true\n        }\n      })\n\n      // remove comment from the data list\n      main.data = main.data.filter((item) => item.id !== id)\n    }\n  }\n\n  /**\n   * @param {Array<CommentData>} comments\n   * @param {boolean} isClear\n   */\n  updateComments(comments, isClear = true) {\n    this.logger && this.logger.info(`updateComments: ${comments.length}, isClear ${isClear}`)\n    const { main } = this\n    if (typeof isClear === 'boolean' && isClear) {\n      main.data = []\n    }\n    main.data = main.data.concat(comments)\n    main.sortData()\n    main.keepPoolWatermark()\n  }\n\n  /**\n   * 设置所有弹幕播放时长\n   * @param {number} duration\n   */\n  setAllDuration(mode = 'scroll', duration, force = true) {\n    this.logger && this.logger.info(`setAllDuration: mode ${mode} duration ${duration} force ${force}`)\n    if (duration) {\n      duration = duration ? duration : 5000\n      if (force) {\n        this.main.forceDuration = duration\n      }\n      this.main.data.forEach((data) => {\n        if (mode === data.mode) {\n          data.duration = duration\n        }\n      })\n      this.main.queue.forEach((item) => {\n        if (mode === item.mode) {\n          item.duration = duration\n          item.pauseMove()\n          if (this.main.status !== 'paused') {\n            item.startMove()\n          }\n        }\n      })\n    }\n  }\n\n  /**\n   * 设置弹幕播放速率，在弹幕播放速度上乘以一个系数，控制速度的变化\n   * @param {number} val\n   */\n  setPlayRate(mode = 'scroll', val) {\n    this.logger && this.logger.info(`setPlayRate: ${val}`)\n    if (isNumber(val) && val > 0) {\n      this.main.playRate = val\n      this.main.queue.forEach((item) => {\n        if (mode === item.mode) {\n          item.pauseMove()\n          if (this.main.status !== 'paused') {\n            item.startMove()\n          }\n        }\n      })\n    }\n  }\n\n  setOpacity(opacity) {\n    this.logger && this.logger.info(`setOpacity: opacity ${opacity}`)\n\n    if (this.container) {\n      this.container.style.opacity = opacity\n    }\n  }\n\n  setFontSize(\n    size,\n    channelSize,\n    options = {\n      reflow: true\n    }\n  ) {\n    this.logger && this.logger.info(`setFontSize: size ${size} channelSize ${channelSize}`)\n    this.fontSize = `${size}px`\n    if (size) {\n      this.main.data.forEach((data) => {\n        if (data.style) {\n          data.style.fontSize = this.fontSize\n        }\n      })\n      this.main.queue.forEach((item) => {\n        if (!item.options.style) {\n          item.options.style = {}\n        }\n\n        item.options.style.fontSize = this.fontSize\n        item.setFontSize(this.fontSize)\n        if (channelSize) {\n          item.top = item.channel_id[0] * channelSize\n          item.topInit()\n        }\n      })\n    }\n    if (channelSize) {\n      this.config.channelSize = channelSize\n\n      if (options.reflow) {\n        this.main.channel.resizeSync()\n      }\n    }\n  }\n\n  setArea(area) {\n    this.logger && this.logger.info(`setArea: area ${area}`)\n    this.config.area = area\n\n    if (area.reflow !== false) {\n      this.main.channel.resizeSync()\n    }\n  }\n\n  hide(mode = 'scroll') {\n    this.logger && this.logger.info(`hide: mode ${mode}`)\n    if (this.hideArr.indexOf(mode) < 0) {\n      this.hideArr.push(mode)\n    }\n    let arr = this.main.queue.filter((item) => mode === item.mode || (mode === 'color' && item.color))\n    arr.forEach((item) => item.remove())\n  }\n\n  show(mode = 'scroll') {\n    this.logger && this.logger.info(`show: mode ${mode}`)\n    let index = this.hideArr.indexOf(mode)\n    if (index > -1) {\n      this.hideArr.splice(index, 1)\n    }\n  }\n\n  /**\n   * @param {'r2l'|'b2t'} direction\n   */\n  setDirection(direction = 'r2l') {\n    this.logger && this.logger.info(`setDirection: direction ${direction}`)\n    this.direction = direction\n    // this.main.channel.resize()\n    this.emit('changeDirection', direction)\n  }\n\n  resize() {\n    this.logger && this.logger.info('resize')\n    this.emit('channel_resize')\n  }\n}\n\nexport default DanmuJs\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","import BaseClass from './baseClass'\nimport Main from './main'\nimport { createDom, hasOwnProperty } from './utils/util'\n\nclass Control extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu) {\n    super()\n    this.setLogger('control')\n    this.danmu = danmu\n    this.main = new Main(danmu)\n    if (!danmu.config.defaultOff) {\n      this.main.start()\n    }\n  }\n\n  createSwitch(state = true) {\n    this.logger && this.logger.info('createSwitch')\n    this.switchBtn = createDom(\n      'dk-switch',\n      '<span class=\"txt\">弹</span>',\n      {},\n      `danmu-switch ${state ? 'danmu-switch-active' : ''}`\n    )\n    return this.switchBtn\n  }\n\n  destroy() {\n    this.logger && this.logger.info('destroy')\n    this.main.destroy()\n    for (const k in this) {\n      if (hasOwnProperty.call(this, k)) {\n        delete this[k]\n      }\n    }\n  }\n}\n\nexport default Control\n","import BaseClass from './baseClass'\nimport Bullet from './bullet'\nimport Channel from './channel'\nimport { hasOwnProperty } from './utils/util'\n\n// 单次尝试入轨弹幕数量越多，长任务及CPU耗时越多\nconst MAX_TRY_COUNT = 0\n\n/**\n * @typedef {import('./baseClass').CommentData} CommentData\n */\n\n/**\n * [Main 弹幕主进程]\n * @type {Class}\n */\nclass Main extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu) {\n    super()\n    this.setLogger('main')\n    this.danmu = danmu\n    this.container = danmu.container\n    this.channel = new Channel(danmu) // 弹幕轨道实例\n\n    /**\n     * @type {Array<CommentData>}\n     */\n    this.data = [].concat(danmu.config.comments)\n    this.playedData = []\n\n    /**\n     * @type {Array<Bullet>}\n     */\n    this.queue = [] // 等待播放的弹幕队列\n    this.timer = null // 弹幕动画定时器句柄\n\n    /**\n     * 弹幕播放速率\n     * @type {number}\n     */\n    this.playRate = 1\n\n    /**\n     * @type {'normal'|'stop'}\n     */\n    this.retryStatus = 'normal'\n    this.interval = danmu.config.interval // 弹幕队列缓存间隔\n    /**\n     * @type {'idle' | 'paused' | 'playing' | 'closed'}\n     */\n    this._status = 'idle' // 当前弹幕正在闲置\n    /**\n     * @type {Array<[HTMLElement, string, Function]>}\n     */\n    this._events = []\n\n    this._bindEvents()\n  }\n\n  get status() {\n    return this._status\n  }\n\n  destroy() {\n    this.logger && this.logger.info('destroy')\n    this._unbindEvents()\n    this._cancelTick()\n    this.channel && this.channel.destroy()\n    this.data = []\n    for (let k in this) {\n      delete this[k]\n    }\n  }\n\n  /**\n   * @private\n   */\n  _bindEvents() {\n    const { danmu, container } = this\n    this._unbindEvents()\n\n    /**\n     * 在渲染队列中移除已经展示完的弹幕对象\n     * @param {{\n     *   bullet: Bullet\n     * }} data\n     */\n    const updateQueue = ({ bullet }) => {\n      const { data, queue } = this\n      queue.some((item, index) => {\n        if (item.id === bullet.id) {\n          queue.splice(index, 1)\n          return true\n        } else {\n          return false\n        }\n      })\n      data.some((item) => {\n        if (item.id === bullet.id) {\n          item.attached_ = false\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n    this._events.push([danmu, 'bullet_remove', updateQueue])\n\n    /**\n     * @param {TransitionEvent} e\n     */\n    const onTransitionEnd = (e) => {\n      const bullet = this._getBulletByEvt(e)\n\n      if (bullet) {\n        bullet.status = 'end'\n        bullet.remove(false)\n      }\n    }\n    this._events.push([container, 'transitionend', onTransitionEnd])\n\n    if (danmu.config.mouseControl || danmu.config.mouseEnterControl) {\n      /**\n       * @param {MouseEvent} e\n       */\n      const onMouseover = (e) => {\n        const { danmu } = this\n        let bullet\n\n        if (!danmu || (danmu.mouseControl && danmu.config.mouseControlPause)) {\n          return\n        }\n\n        bullet = this._getBulletByEvt(e)\n\n        if (bullet) {\n          if (bullet.status !== 'waiting' && bullet.status !== 'end') {\n            danmu.emit('bullet_hover', {\n              bullet: bullet,\n              event: e\n            })\n          }\n        }\n      }\n      this._events.push([container, 'mouseover', onMouseover])\n    }\n\n    this._events.forEach((item) => {\n      if (item[0].addEventListener) {\n        item[0].addEventListener(item[1], item[2], false)\n      } else if (item[0].on) {\n        item[0].on(item[1], item[2])\n      }\n    })\n  }\n\n  /**\n   * @private\n   */\n  _unbindEvents() {\n    if (this._events.length) {\n      this._events.forEach((item) => {\n        if (item[0].removeEventListener) {\n          item[0].removeEventListener(item[1], item[2], false)\n        } else if (item[0].off) {\n          item[0].off(item[1], item[2])\n        }\n      })\n      this._events = []\n    }\n  }\n\n  /**\n   * @private\n   */\n  _cancelTick() {\n    if (this.handleTimer) {\n      clearTimeout(this.handleTimer)\n      this.handleTimer = null\n    }\n  }\n\n  /**\n   * @private\n   */\n  _startTick() {\n    const self = this\n    self.retryStatus = 'normal'\n\n    self._cancelTick()\n    self.sortData()\n\n    function dataHandle() {\n      if (self._status === 'closed' && self.retryStatus === 'stop') {\n        self._cancelTick()\n        return\n      }\n      if (self._status === 'playing') {\n        self.readData()\n        self.dataHandle()\n      }\n      if (self.retryStatus !== 'stop' || self._status === 'paused') {\n        self.handleTimer = setTimeout(dataHandle, 250)\n      }\n    }\n    dataHandle()\n  }\n  // 启动弹幕渲染主进程\n  start() {\n    this.logger && this.logger.info('start')\n    const self = this\n\n    if (self._status === 'playing') {\n      return\n    }\n\n    self._status = 'playing'\n    self.queue = []\n    self.container.innerHTML = ''\n    self.channel.reset()\n    self._startTick()\n  }\n  stop() {\n    this.logger && this.logger.info('stop')\n    const self = this\n\n    if (self._status === 'closed') {\n      return\n    }\n\n    self._status = 'closed'\n    self.retryStatus = 'stop'\n    self.queue = []\n\n    if (self.container) {\n      self.container.innerHTML = ''\n    }\n    self.channel && self.channel.reset()\n    self._cancelTick()\n  }\n  clear() {\n    this.logger && this.logger.info('clear')\n    this.channel && this.channel.reset()\n    this.data = []\n    this.queue = []\n    if (this.container) {\n      this.container.innerHTML = ''\n    }\n  }\n  play() {\n    if (this._status === 'closed') {\n      this.logger && this.logger.info('play ignored')\n      return\n    }\n\n    this.logger && this.logger.info('play')\n    this._status = 'playing'\n    let channels = this.channel.channels\n    if (channels && channels.length > 0) {\n      // eslint-disable-next-line no-extra-semi\n      ;['scroll', 'top', 'bottom'].forEach((key) => {\n        this.queue.forEach((item) => {\n          item.startMove()\n          item.resized = true\n        })\n        for (let i = 0; i < channels.length; i++) {\n          channels[i].queue[key].forEach((item) => {\n            item.resized = false\n          })\n        }\n      })\n    }\n    this._startTick()\n  }\n  pause() {\n    if (this._status === 'closed') {\n      this.logger && this.logger.info('pause ignored')\n      return\n    }\n\n    this.logger && this.logger.info('pause')\n    this._status = 'paused'\n    this._cancelTick()\n\n    let channels = this.channel.channels\n    if (channels && channels.length > 0) {\n      // ['scroll', 'top', 'bottom'].forEach( key => {\n      //   for (let i = 0; i < channels.length; i++) {\n      //     channels[i].queue[key].forEach(item => {\n      //       item.pauseMove()\n      //     })\n      //   }\n      // })\n      this.queue.forEach((item) => {\n        item.pauseMove()\n      })\n    }\n  }\n  dataHandle() {\n    const self = this\n    if (this._status === 'paused' || this._status === 'closed') {\n      return\n    }\n    if (self.queue.length) {\n      self.queue.forEach((item) => {\n        if (item.status === 'waiting') {\n          item.startMove()\n        }\n      })\n    }\n  }\n  readData() {\n    const self = this\n    const { danmu, interval, channel } = self,\n      player = danmu.player\n    let result,\n      /**\n       * @type {Bullet}\n       */\n      bullet,\n      /**\n       * @type {Array<CommentData>}\n       */\n      list\n\n    if (!danmu.isReady || !danmu.main) return\n\n    if (player) {\n      const currentTime = player.currentTime ? Math.floor(player.currentTime * 1000) : 0\n\n      list = self.data.filter((item) => {\n        if (!item.start && danmu.hideArr.indexOf(item.mode) < 0) {\n          if (!item.color || danmu.hideArr.indexOf('color') < 0) {\n            item.start = currentTime\n          }\n        }\n        return (\n          !item.attached_ &&\n          danmu.hideArr.indexOf(item.mode) < 0 &&\n          (!item.color || danmu.hideArr.indexOf('color') < 0) &&\n          item.start - interval <= currentTime &&\n          currentTime <= item.start + interval\n        )\n      })\n\n      if (danmu.config.highScorePriority) {\n        // 高积分弹幕优先展示\n        list.sort((prev, cur) => (cur.prior && !prev.prior) || (cur.score || -1) - (prev.score || -1))\n      }\n\n      if (danmu.live) {\n        self.data = []\n      }\n    } else {\n      list = self.data.splice(0, 1)\n      if (list.length === 0) list = self.playedData.splice(0, 1)\n    }\n\n    if (list.length > 0 && channel.checkAvailableTrack(list[0].mode)) {\n      // 提前更新轨道位置信息, 减少Bullet频繁读取容器dom信息\n      channel.updatePos()\n\n      let tryCount = MAX_TRY_COUNT\n\n      ListLoop: for (let i = 0, item; i < list.length; i++) {\n        item = list[i]\n        if (self.forceDuration && self.forceDuration !== item.duration) {\n          item.duration = self.forceDuration\n        }\n        bullet = new Bullet(danmu, item)\n        if (!bullet.bulletCreateFail) {\n          bullet.attach()\n          item.attached_ = true\n          result = channel.addBullet(bullet)\n\n          if (result.result) {\n            self.queue.push(bullet)\n            bullet.topInit()\n\n            tryCount = MAX_TRY_COUNT\n          } else {\n            bullet.detach()\n            for (let k in bullet) {\n              if (hasOwnProperty.call(bullet, k)) {\n                delete bullet[k]\n              }\n            }\n            bullet = null\n            item.attached_ = false\n            if (item.noDiscard) {\n              if (item.prior) {\n                self.data.unshift(item)\n              } else {\n                self.data.push(item)\n              }\n            }\n\n            if (tryCount === 0) {\n              break ListLoop\n            } else {\n              tryCount--\n            }\n          }\n        } else {\n          if (tryCount === 0) {\n            break ListLoop\n          } else {\n            tryCount--\n          }\n        }\n      }\n    }\n  }\n  sortData() {\n    this.data.sort((prev, cur) => (prev.start || -1) - (cur.start || -1))\n  }\n\n  keepPoolWatermark() {\n    const { config, player } = this.danmu\n    const { data } = this\n    const priorComments = []\n    let deleteCount = 0\n\n    // Support data pool to control watermark automatically\n    if (typeof config.maxCommentsLength === 'number' && data.length > config.maxCommentsLength) {\n      deleteCount = data.length - config.maxCommentsLength\n\n      for (let i = 0, comment; i < deleteCount; i++) {\n        comment = data[i]\n        if (comment.prior && !comment.attached_) {\n          priorComments.push(data[i])\n        }\n      }\n    } else if (config.dropStaleComments && player && player.currentTime) {\n      const currentTime = Math.floor(player.currentTime * 1000),\n        timePoint = currentTime - config.interval\n\n      if (timePoint > 0) {\n        for (let i = 0, comment; i < data.length; i++) {\n          comment = data[i]\n          if (comment.prior && !comment.attached_) {\n            priorComments.push(data[i])\n          }\n\n          if (comment.start > timePoint) {\n            deleteCount = i\n            break\n          }\n        }\n      }\n    }\n\n    if (deleteCount > 0) {\n      data.splice(0, deleteCount)\n\n      // Keep high-priority comments data.\n      this.data = priorComments.concat(data)\n    }\n  }\n\n  /**\n   * @param {EventTarget} e\n   * @private\n   */\n  _getBulletByEvt(e) {\n    const target = e.target || e.srcElement\n    const { queue } = this\n\n    let bullet\n    for (let i = 0, item; i < queue.length; i++) {\n      item = queue[i]\n      if (item && item.el && (item.el === target || item.el.contains(target))) {\n        bullet = item\n        break\n      }\n    }\n\n    return bullet\n  }\n}\n\nexport default Main\n","import BaseClass from './baseClass'\nimport Log from './utils/logger'\nimport { copyDom, isFunction, isNumber, styleCSSText, styleUtil } from './utils/util'\n\n// 减少频繁的内存创建\nconst logger = new Log('bullet')\n\n/**\n * [Bullet 弹幕构造类]\n *\n * @description\n *  1. 几乎所有事件都可以被代理（包括CSS事件），Bullet内不要进行事件绑定。所有事件绑定均在main层处理\n */\nexport class Bullet extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   * @param {import('./baseClass').CommentData} options\n   */\n  constructor(danmu, options = {}) {\n    super()\n    const { container, recycler, config } = danmu\n\n    this.setLogger(logger)\n    // this.logger && this.logger.info('options.moveV', options.moveV)\n    this.danmu = danmu\n    this.options = options\n    /** @type {number} - milliseconds */\n    this.duration = options.duration\n    this.id = options.id\n    this.container = container\n    /** @type {'scroll' | 'top' | 'bottom'} */\n    this.mode = options.mode === 'top' || options.mode === 'bottom' ? options.mode : 'scroll'\n    this.start = options.start\n    this.prior = options.prior\n    this.realTime = options.realTime\n    this.color = options.color\n    this.bookChannelId = options.bookChannelId\n    this.reuseDOM = true\n    this.noCopyEl = !!(config.disableCopyDOM || options.disableCopyDOM)\n    this.recycler = recycler\n    /**\n     * @type {number} - seconds\n     * @private\n     */\n    this._fullySlideInScreenDuration = undefined\n    /**\n     * @type {number} - milliseconds\n     * @private\n     */\n    this._lastMoveTime = undefined\n    /** @type {'waiting'|'start'|'end'} */\n    this.status = 'waiting'\n\n    if (!options.elLazyInit) {\n      this.bulletCreateFail = !this._makeEl()\n    }\n  }\n  get moveV() {\n    const self = this\n    const { danmu, options } = self\n    let v = self._moveV\n\n    if (!v) {\n      if (options.moveV) {\n        v = options.moveV\n      } else {\n        if (self.elPos) {\n          const ctPos = danmu.containerPos\n          const distance =\n            self.direction === 'b2t'\n              ? ctPos.height + (danmu.config.chaseEffect ? self.height : 0)\n              : ctPos.width + (danmu.config.chaseEffect ? self.width : 0)\n\n          v = (distance / self.duration) * 1000\n        }\n      }\n\n      if (v) {\n        v *= danmu.main.playRate\n\n        // 固化速度，否则resize时外部获取当前弹幕时会重新计算速度，导致布局异常（重叠），同时提高性能。\n        self._moveV = v\n      }\n    }\n    return v\n  }\n  get direction() {\n    return this.danmu.direction\n  }\n  get fullySlideIntoScreen() {\n    const self = this\n    let flag = true\n\n    if (self.mode === 'scroll' && self._lastMoveTime && self._fullySlideInScreenDuration > 0) {\n      const now = new Date().getTime()\n      const diff = (now - self._lastMoveTime) / 1000\n\n      if (diff >= self._fullySlideInScreenDuration) {\n        flag = true\n      } else {\n        flag = false\n      }\n    }\n    return flag\n  }\n\n  /**\n   * @private\n   * @returns {Boolean}\n   */\n  _makeEl() {\n    const { danmu, options } = this\n    const { config, globalHooks } = danmu\n    /**\n     * @type {HTMLElement}\n     */\n    let el\n    let cssText = ''\n    let style = options.style || {}\n\n    // The use of translate3d pushes css animations into hardware acceleration for more power!\n    // Use 'perspective' to try to fix flickering problem after switching to the transform above\n    style['perspective'] = '500em'\n\n    // !!! 'backface-visibility' will cause translateX/Y stop rendering in firefox\n    // style['backfaceVisibility'] = 'hidden'\n    // style['webkitBackfaceVisibility'] = 'hidden'\n\n    if (options.el || options.elLazyInit) {\n      if (this.noCopyEl) {\n        this.reuseDOM = false\n      }\n\n      if (options.elLazyInit) {\n        if (isFunction(globalHooks.bulletCreateEl)) {\n          try {\n            const result = globalHooks.bulletCreateEl(options)\n\n            if (result instanceof HTMLElement) {\n              el = result\n            } else {\n              el = result.el\n            }\n          } catch (e) {}\n        }\n      } else {\n        if (options.el.nodeType === 1 && !options.el.parentNode) {\n          if (this.reuseDOM) {\n            let copyDOM = copyDom(options.el)\n            if (options.eventListeners && options.eventListeners.length > 0) {\n              options.eventListeners.forEach((eventListener) => {\n                copyDOM.addEventListener(eventListener.event, eventListener.listener, eventListener.useCapture || false)\n              })\n            }\n            el = this.recycler.use()\n            if (el.childNodes.length > 0) {\n              el.innerHTML = ''\n            }\n            if (el.textContent) {\n              el.textContent = ''\n            }\n            el.appendChild(copyDOM)\n          } else {\n            el = options.el\n          }\n        }\n      }\n    } else if (typeof options.txt === 'string') {\n      el = this.recycler.use()\n      el.textContent = options.txt\n    }\n\n    if (!el || !danmu.main) {\n      return false\n    }\n\n    let offset\n    if (isNumber(config.bulletOffset) && config.bulletOffset >= 0) {\n      offset = config.bulletOffset\n    } else {\n      const containerPos = danmu.containerPos\n      offset = containerPos.width / 10 > 100 ? 100 : containerPos.width / 10\n    }\n    const random = options.realTime ? 0 : Math.floor(Math.random() * offset)\n    const left = this.updateOffset(random, true)\n\n    style.left = left\n    Object.keys(style).forEach((key) => {\n      const bbqKey = key.replace(/[A-Z]/g, (val) => {\n        return '-' + val.toLowerCase()\n      })\n      cssText += `${bbqKey}:${style[key]};`\n    })\n    styleCSSText(el, cssText)\n\n    /**\n     * @type {HTMLElement}\n     */\n    this.el = el\n    if (options.like && options.like.el) {\n      this.setLikeDom(options.like.el, options.like.style)\n    }\n\n    return true\n  }\n\n  updateOffset(val, dryRun = false) {\n    this.random = val\n    const left = this.danmu.containerPos.width + val + 'px'\n\n    if (!dryRun) {\n      styleUtil(this.el, 'left', this.danmu.containerPos.width + val + 'px')\n    }\n\n    return left\n  }\n  attach() {\n    // this.logger && this.logger.info(`attach #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n\n    if (self.options.elLazyInit && !self.el) {\n      self._makeEl()\n    }\n\n    // 防止外部钩子进行弹幕实例销毁，或者其他异常操作\n    if (!self.danmu || !self.danmu.main) {\n      return\n    }\n\n    const { danmu, options, el } = self\n    const { globalHooks } = danmu\n\n    if (globalHooks.bulletAttaching) {\n      globalHooks.bulletAttaching(options)\n    }\n\n    if (!self.container.contains(el)) {\n      self.container.appendChild(el)\n    }\n    self.elPos = el.getBoundingClientRect()\n    if (self.direction === 'b2t') {\n      self.width = self.elPos.height\n      self.height = self.elPos.width\n    } else {\n      self.width = self.elPos.width\n      self.height = self.elPos.height\n    }\n    if (self.moveV) {\n      self.duration = ((self.danmu.containerPos.width + self.random + self.width) / self.moveV) * 1000\n    }\n\n    if (globalHooks.bulletAttached) {\n      globalHooks.bulletAttached(options, el)\n    }\n  }\n  detach() {\n    // this.logger && this.logger.info(`detach #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    const { el, danmu, options } = self\n    const { globalHooks } = danmu\n\n    if (el) {\n      // run hooks\n      if (globalHooks.bulletDetaching) {\n        globalHooks.bulletDetaching(options)\n      }\n\n      if (self.reuseDOM) {\n        self.recycler.unused(el)\n      } else {\n        if (el.parentNode) {\n          el.parentNode.removeChild(el)\n        }\n      }\n\n      // run hooks\n      if (globalHooks.bulletDetached) {\n        globalHooks.bulletDetached(options, el)\n      }\n\n      self.el = null\n    }\n\n    self.elPos = undefined\n  }\n  topInit() {\n    this.logger && this.logger.info(`topInit #${this.options.txt || '[DOM Element]'}#`)\n    if (this.direction === 'b2t') {\n      styleUtil(this.el, 'transformOrigin', 'left top')\n      styleUtil(\n        this.el,\n        'transform',\n        `translateX(-${this.top}px) translateY(${this.danmu.containerPos.height}px) translateZ(0px) rotate(90deg)`\n      )\n      styleUtil(this.el, 'transition', 'transform 0s linear 0s')\n    } else {\n      styleUtil(this.el, 'top', `${this.top}px`)\n    }\n  }\n  pauseMove(isFullscreen = false) {\n    // this.logger && this.logger.info(`pauseMove #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    if (self.status === 'paused') {\n      return\n    }\n    if (self.status !== 'forcedPause') {\n      this.status = 'paused'\n    }\n\n    // 将记忆速度删除，以备通过接口调整速度或duration时重计速度\n    self._moveV = undefined\n\n    if (!this.el) {\n      return\n    }\n    if (this.mode === 'scroll') {\n      const ctPos = self.danmu.containerPos\n      if (isFullscreen) {\n        let pastDuration = (new Date().getTime() - self._lastMoveTime) / 1000\n        let pastS = pastDuration * this.moveV\n        let ratio = 0\n        let nowS = 0\n        if (self.moveMoreS - pastS >= 0) {\n          if (this.direction === 'b2t') {\n            ratio = (self.moveMoreS - pastS) / self.moveContainerHeight\n            nowS = ratio * ctPos.height\n          } else {\n            ratio = (self.moveMoreS - pastS) / self.moveContainerWidth\n            nowS = ratio * ctPos.width\n          }\n        } else {\n          nowS = self.moveMoreS - pastS\n        }\n        if (this.direction === 'b2t') {\n          styleUtil(\n            this.el,\n            'transform',\n            `translateX(-${this.top}px) translateY(${nowS}px) translateZ(0px) rotate(90deg)`\n          )\n        } else {\n          styleUtil(this.el, 'left', `${nowS}px`)\n        }\n      } else {\n        if (this.direction === 'b2t') {\n          styleUtil(\n            this.el,\n            'transform',\n            `translateX(-${this.top}px) translateY(${\n              this.el.getBoundingClientRect().top - ctPos.top\n            }px) translateZ(0px) rotate(90deg)`\n          )\n        } else {\n          styleUtil(this.el, 'left', `${this.el.getBoundingClientRect().left - ctPos.left}px`)\n        }\n      }\n      if (this.direction === 'b2t') {\n        // this.el.style.transform = `translateX(-${this.top}px) translateY(${nowS}px) translateZ(0px) rotate(90deg)`\n        styleUtil(this.el, 'transition', 'transform 0s linear 0s')\n      } else {\n        styleUtil(this.el, 'transform', 'translateX(0px) translateY(0px) translateZ(0px)')\n        styleUtil(this.el, 'transition', 'transform 0s linear 0s')\n      }\n    } else {\n      if (!this.pastDuration || !this.startTime) {\n        this.pastDuration = 1\n      } else {\n        this.pastDuration = this.pastDuration + new Date().getTime() - this.startTime\n      }\n    }\n  }\n  startMove(force) {\n    // this.logger && this.logger.info(`startMove #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    if (!self.hasMove) {\n      self.danmu.emit('bullet_start', self)\n      self.hasMove = true\n    }\n    if (self.status === 'forcedPause' && !force) return\n    if (!this.el) return\n    if (this.status === 'start') return\n\n    this.status = 'start'\n\n    if (this.mode === 'scroll') {\n      const ctPos = self.danmu.containerPos\n      if (!self.el) {\n        return\n      }\n      const bulletPos = self.el.getBoundingClientRect()\n      let fullyMovedToScreenDistance\n\n      if (this.direction === 'b2t') {\n        fullyMovedToScreenDistance = bulletPos.bottom - ctPos.bottom\n\n        let leftDuration = (bulletPos.bottom - ctPos.top) / this.moveV\n        styleUtil(self.el, 'transition', `transform ${leftDuration}s linear 0s`)\n        styleUtil(\n          self.el,\n          'transform',\n          `translateX(-${self.top}px) translateY(-${self.height}px) translateZ(0px) rotate(90deg)`\n        )\n        self._lastMoveTime = new Date().getTime()\n        self.moveMoreS = bulletPos.top - ctPos.top\n        self.moveContainerHeight = ctPos.height\n      } else {\n        fullyMovedToScreenDistance = bulletPos.right - ctPos.right\n        const leftDistance = bulletPos.right - ctPos.left\n        const leftDuration = leftDistance / self.moveV\n\n        if (bulletPos.right > ctPos.left) {\n          styleUtil(self.el, 'transition', `transform ${leftDuration}s linear 0s`)\n          styleUtil(self.el, 'transform', `translateX(-${leftDistance}px) translateY(0px) translateZ(0px)`)\n\n          self._lastMoveTime = new Date().getTime()\n          self.moveMoreS = bulletPos.left - ctPos.left\n          self.moveContainerWidth = ctPos.width\n        } else {\n          self.status = 'end'\n          self.remove()\n        }\n      }\n\n      self._fullySlideInScreenDuration = fullyMovedToScreenDistance / self.moveV\n    } else {\n      const newTimestamp = new Date().getTime()\n      const leftDuration =\n        (this.startTime && newTimestamp - this.startTime > this.duration\n          ? newTimestamp - this.startTime\n          : this.duration) / 1000\n      styleUtil(self.el, 'left', '50%')\n      styleUtil(self.el, 'margin', `0 0 0 -${this.width / 2}px`)\n      styleUtil(self.el, 'visibility', 'hidden')\n      styleUtil(self.el, 'transition', `visibility ${leftDuration}s 0s`)\n      if (!this.pastDuration) {\n        this.pastDuration = 1\n      }\n      this.startTime = newTimestamp\n    }\n  }\n  remove(needPause = true) {\n    this.logger && this.logger.info(`remove #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n\n    if (needPause) {\n      self.pauseMove()\n    }\n\n    if (self.el && self.el.parentNode) {\n      self.detach()\n      if (this.options.el && this.options.el.nodeType === 1 && this.noCopyEl) {\n        styleUtil(this.options.el, 'transform', 'none')\n      }\n      self.danmu.emit('bullet_remove', {\n        bullet: self\n      })\n    }\n  }\n\n  setFontSize(size) {\n    if (this.el) {\n      this.el.style['fontSize'] = size\n    }\n  }\n  setLikeDom(el, style) {\n    if (el) {\n      Object.keys(style).forEach(function (key) {\n        el.style[key] = style[key]\n      })\n      let likeClass = 'danmu-like'\n      el.className = likeClass\n      if (this.el) {\n        let children = this.el.querySelector('.' + likeClass)\n        if (children) {\n          this.el.removeChild(children)\n        }\n        this.el.innerHTML = `${this.el.innerHTML}${el.outerHTML}`\n      }\n    }\n    return el\n  }\n}\n\nexport default Bullet\n","import BaseClass from './baseClass'\nimport { attachEventListener, hasOwnProperty, isNumber } from './utils/util'\nimport { validAreaLineRule } from './utils/validator'\n\n/**\n * @typedef {import('./bullet').Bullet} Bullet\n */\n\n/**\n * [Channel 弹幕轨道控制]\n */\nclass Channel extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu) {\n    super()\n    const self = this\n\n    self.setLogger('channel')\n    self.danmu = danmu\n    self.width = 0\n    self.height = 0\n    self.reset(true)\n    /** @type {Array.<{id: number, queue: {scroll: Array.<Bullet>, top: Array.<Bullet>, bottom: Array.<Bullet>}, operating: {scroll: boolean, top: boolean, bottom: boolean}, bookId: {}}>} */\n    self.channels = []\n    self.updatePos()\n\n    attachEventListener(\n      this.danmu,\n      'bullet_remove',\n      (r) => {\n        self.removeBullet(r.bullet)\n      },\n      'destroy'\n    )\n    attachEventListener(\n      this.danmu,\n      'channel_resize',\n      () => {\n        self.resize()\n      },\n      'destroy'\n    )\n  }\n\n  get direction() {\n    return this.danmu.direction\n  }\n\n  checkAvailableTrack(mode = 'scroll') {\n    const { channels } = this\n    let flag = false\n\n    if (mode === 'scroll') {\n      for (let i = 0, channel; i < channels.length; i++) {\n        channel = channels[i]\n        flag = true\n        if (channel.operating[mode]) {\n          flag = false\n          continue\n        }\n\n        // 当前轨道 - 最后入轨弹幕\n        const curBullet = channel.queue[mode][0]\n        if (curBullet && !curBullet.fullySlideIntoScreen) {\n          flag = false\n          continue\n        }\n        if (flag) {\n          break\n        }\n      }\n    } else {\n      flag = true\n    }\n\n    return flag\n  }\n\n  destroy() {\n    this.logger && this.logger.info('destroy')\n    this.channels.splice(0, this.channels.length)\n    this._cancelResizeTimer()\n\n    // clear prop at end\n    for (const k in this) {\n      if (hasOwnProperty.call(this, k)) {\n        delete this[k]\n      }\n    }\n  }\n\n  reset(isInit = false) {\n    this.logger && this.logger.info('reset')\n    const self = this\n    const { container, bulletBtn } = self.danmu\n\n    self.container = container\n\n    // bullet on waiting room\n    if (bulletBtn && bulletBtn.main) {\n      bulletBtn.main.queue.forEach((item) => {\n        item.remove()\n      })\n    }\n    // bullet on track\n    if (self.channels && self.channels.length > 0) {\n      // eslint-disable-next-line no-extra-semi\n      ;['scroll', 'top', 'bottom'].forEach((key) => {\n        for (let i = 0; i < self.channels.length; i++) {\n          self.channels[i].queue[key].forEach((item) => {\n            item.remove()\n          })\n        }\n      })\n    }\n    if (bulletBtn && bulletBtn.main && bulletBtn.main.data) {\n      bulletBtn.main.data.forEach((item) => {\n        item.attached_ = false\n      })\n    }\n\n    function channelReset() {\n      if (!self.danmu || !self.danmu.container) {\n        return\n      }\n      const { container } = self.danmu\n      let size = container.getBoundingClientRect()\n      self.width = size.width\n      self.height = size.height\n\n      if (self.resetId) {\n        cancelAnimationFrame(self.resetId)\n        self.resetId = null\n      }\n\n      const { channelSize, channelCount, channels } = self._initChannels()\n\n      self.channelCount = channelCount\n      self.channels = channels\n      if (self.direction === 'b2t') {\n        self.channelWidth = channelSize\n      } else {\n        self.channelHeight = channelSize\n      }\n    }\n\n    if (isInit) {\n      this.resetId = requestAnimationFrame(channelReset)\n    } else {\n      channelReset()\n    }\n  }\n\n  getRealOccupyArea() {\n    return {\n      width: this.width,\n      height: this.height\n    }\n  }\n\n  updatePos() {\n    const pos = this.container.getBoundingClientRect()\n\n    this.containerPos = pos\n    this.containerWidth = pos.width\n    this.containerHeight = pos.height\n    this.containerTop = pos.top\n    this.containerBottom = pos.bottom\n    this.containerLeft = pos.left\n    this.containerRight = pos.right\n  }\n\n  /**\n   * Feature:\n   * 1. 长弹幕速度较快，更容易出现追击问题，需要调整Offset\n   * 2. 需要按实时性RealTime展示的弹幕，则不能再用duration来计算速度，这样会产生追击重叠问题\n   *\n   * @param {import('./bullet').Bullet} bullet\n   */\n  addBullet(bullet) {\n    // this.logger && this.logger.info(`addBullet ${bullet.options.txt || '[DOM Element]'}`)\n    const self = this\n    const danmu = this.danmu\n    const channels = this.channels\n    let channelHeight, channelWidth, occupy\n\n    if (self.direction === 'b2t') {\n      channelWidth = this.channelWidth\n      occupy = Math.ceil(bullet.width / channelWidth)\n    } else {\n      channelHeight = this.channelHeight\n      occupy = Math.ceil(bullet.height / channelHeight)\n    }\n    if (occupy > channels.length) {\n      return {\n        result: false,\n        message: `exceed channels.length, occupy=${occupy},channelsSize=${channels.length}`\n      }\n    } else {\n      let flag = true,\n        channel,\n        pos = -1\n      for (let i = 0, max = channels.length; i < max; i++) {\n        if (channels[i].queue[bullet.mode].some((item) => item.id === bullet.id)) {\n          return {\n            result: false,\n            message: `exited, channelOrder=${i},danmu_id=${bullet.id}`\n          }\n        }\n      }\n      if (bullet.mode === 'scroll') {\n        for (let i = 0, max = channels.length - occupy; i <= max; i += occupy) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            channel = channels[j]\n            if (channel.operating.scroll || (channel.bookId.scroll && channel.bookId.scroll !== bullet.id)) {\n              flag = false\n              break\n            }\n            channel.operating.scroll = true\n\n            // 当前轨道 - 最后入轨弹幕\n            const curBullet = channel.queue.scroll[0]\n\n            if (curBullet) {\n              const curBulletPos = curBullet.el.getBoundingClientRect()\n\n              // 1. 检测最后入轨弹幕是否已经完全飘入容器区域\n              if (self.direction === 'b2t') {\n                if (curBulletPos.bottom >= self.containerPos.bottom) {\n                  flag = false\n                  channel.operating.scroll = false\n                  break\n                }\n              } else {\n                if (curBulletPos.right >= self.containerPos.right) {\n                  flag = false\n                  channel.operating.scroll = false\n                  break\n                }\n              }\n\n              let curS,\n                curV = curBullet.moveV,\n                curT,\n                newV = bullet.moveV,\n                catchS\n              if (self.direction === 'b2t') {\n                curS = curBulletPos.bottom - self.containerTop\n                curT = curS / curV\n\n                catchS = self.containerHeight + bullet.random - curS\n              } else {\n                curS = curBulletPos.right - self.containerLeft\n                curT = curS / curV\n\n                catchS = self.containerWidth + bullet.random - curS\n              }\n\n              // 2. 当前轨道内，新弹幕速度大于最后一个入轨弹幕速度，考虑碰撞问题\n              if (newV > curV) {\n                let catchT = catchS / (newV - curV)\n\n                if (!danmu.config.bOffset) {\n                  danmu.config.bOffset = 0\n                }\n\n                // 3. 相遇时间小于最后弹幕飘出时间\n                if (curT + danmu.config.bOffset >= catchT) {\n                  // 根据前一个弹幕剩余飘出时间，计算新弹幕需要增加的offset\n                  const offset = curT * newV - self.containerPos.width\n                  if (offset > 0) {\n                    bullet.updateOffset(offset + (1 + Math.ceil(5 * Math.random())) /* 防止最后过于接近 */)\n                  }\n                }\n              }\n            }\n            channel.operating.scroll = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      } else if (bullet.mode === 'top') {\n        for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            if (j > Math.floor(channels.length / 2)) {\n              flag = false\n              break\n            }\n            channel = channels[j]\n            if (channel.operating[bullet.mode]) {\n              flag = false\n              break\n            }\n            if ((channel.bookId[bullet.mode] || bullet.prior) && channel.bookId[bullet.mode] !== bullet.id) {\n              flag = false\n              break\n            }\n            channel.operating[bullet.mode] = true\n            if (channel.queue[bullet.mode].length > 0) {\n              flag = false\n              channel.operating[bullet.mode] = false\n              break\n            }\n            channel.operating[bullet.mode] = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      } else if (bullet.mode === 'bottom') {\n        for (let i = channels.length - occupy; i >= 0; i--) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            if (j <= Math.floor(channels.length / 2)) {\n              flag = false\n              break\n            }\n            channel = channels[j]\n            if (channel.operating[bullet.mode]) {\n              flag = false\n              break\n            }\n            if ((channel.bookId[bullet.mode] || bullet.prior) && channel.bookId[bullet.mode] !== bullet.id) {\n              flag = false\n              break\n            }\n            channel.operating[bullet.mode] = true\n            if (channel.queue[bullet.mode].length > 0) {\n              flag = false\n              channel.operating[bullet.mode] = false\n              break\n            }\n            channel.operating[bullet.mode] = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      }\n\n      if (pos !== -1) {\n        for (let i = pos, max = pos + occupy; i < max; i++) {\n          channel = channels[i]\n          channel.operating[bullet.mode] = true\n          channel.queue[bullet.mode].unshift(bullet)\n          if (bullet.prior) {\n            delete channel.bookId[bullet.mode]\n            self.logger && self.logger.info(i + '号轨道恢复正常使用')\n          }\n          channel.operating[bullet.mode] = false\n        }\n        if (bullet.prior) {\n          self.logger && self.logger.info(bullet.id + '号优先弹幕运行完毕')\n          delete bullet['bookChannelId']\n          if (danmu.player) {\n            let dataList = danmu.bulletBtn.main.data\n            dataList.some(function (item) {\n              if (item.id === bullet.id) {\n                delete item['bookChannelId']\n                return true\n              } else {\n                return false\n              }\n            })\n          }\n        }\n        bullet.channel_id = [pos, occupy]\n        bullet.el.setAttribute('data-line-index', pos + 1)\n\n        if (self.direction === 'b2t') {\n          bullet.top = pos * channelWidth\n          if (self.danmu.config.area && self.danmu.config.area.start) {\n            bullet.top += self.containerWidth * self.danmu.config.area.start\n          }\n        } else {\n          bullet.top = pos * channelHeight\n          if (self.danmu.config.area && self.danmu.config.area.start) {\n            bullet.top += self.containerHeight * self.danmu.config.area.start\n          }\n        }\n        return {\n          result: bullet,\n          message: 'success'\n        }\n      } else {\n        if (bullet.options.realTime) {\n          // 找到应该被删的 danmu\n          let start = 0\n          let deleteIndex = -1\n          let deleteItem = null\n          self.danmu.bulletBtn.main.queue.forEach((item, index) => {\n            if (\n              !item.prior &&\n              !item.options.realTime &&\n              item.el &&\n              item.el.getBoundingClientRect().left > self.containerPos.right &&\n              item.start >= start\n            ) {\n              start = item.start\n              deleteIndex = index\n              deleteItem = item\n            }\n          })\n          if (deleteItem) {\n            deleteItem.remove()\n            self.removeBullet(deleteItem)\n            self.danmu.bulletBtn.main.queue.splice(deleteIndex, 1)\n            bullet.channel_id = deleteItem.channel_id\n            for (\n              let i = deleteItem.channel_id[0], max = deleteItem.channel_id[0] + deleteItem.channel_id[1];\n              i < max;\n              i++\n            ) {\n              channel = channels[i]\n              channel.operating[bullet.mode] = true\n              channel.queue[bullet.mode].unshift(bullet)\n              if (bullet.prior) {\n                delete channel.bookId[bullet.mode]\n              }\n              channel.operating[bullet.mode] = false\n            }\n            bullet.top = deleteItem.top\n            if (self.danmu.config.area && self.danmu.config.area.start) {\n              bullet.top += self.containerHeight * self.danmu.config.area.start\n            }\n            return {\n              result: bullet,\n              message: 'success'\n            }\n          }\n        }\n\n        if (bullet.prior) {\n          if (!bullet.bookChannelId && !self.danmu.live) {\n            pos = -1\n            for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n              flag = true\n              for (let j = i; j < i + occupy; j++) {\n                if (channels[j].bookId[bullet.mode]) {\n                  flag = false\n                  break\n                }\n              }\n              if (flag) {\n                pos = i\n                break\n              }\n            }\n            if (pos !== -1) {\n              for (let j = pos; j < pos + occupy; j++) {\n                channels[j].bookId[bullet.mode] = bullet.id\n                self.logger && self.logger.info(j + '号轨道被' + bullet.id + '号优先弹幕预定')\n              }\n              let nextAddTime = 2\n              if (danmu.player) {\n                let dataList = danmu.bulletBtn.main.data\n                dataList.some(function (item) {\n                  if (item.id === bullet.id) {\n                    self.logger && self.logger.info(bullet.id + '号优先弹幕将于' + nextAddTime + '秒后再次请求注册')\n                    item.start += nextAddTime * 1000\n                    item.bookChannelId = [pos, occupy]\n                    self.logger && self.logger.info(`${bullet.id}号优先弹幕预定了${pos}~${pos + occupy - 1}号轨道`)\n                    return true\n                  } else {\n                    return false\n                  }\n                })\n              }\n            }\n          } else {\n            let nextAddTime = 2\n            if (danmu.player) {\n              let dataList = danmu.bulletBtn.main.data\n              dataList.some(function (item) {\n                if (item.id === bullet.id) {\n                  self.logger && self.logger.info(bullet.id + '号优先弹幕将于' + nextAddTime + '秒后再次请求注册')\n                  item.start += nextAddTime * 1000\n                  return true\n                } else {\n                  return false\n                }\n              })\n            }\n          }\n        }\n\n        return {\n          result: false,\n          message: 'no surplus will right'\n        }\n      }\n    }\n  }\n  removeBullet(bullet) {\n    this.logger && this.logger.info(`removeBullet ${bullet.options.txt || '[DOM Element]'}`)\n\n    let channels = this.channels\n    let channelId = bullet.channel_id\n    let channel\n    for (let i = channelId[0], max = channelId[0] + channelId[1]; i < max; i++) {\n      channel = channels[i]\n      if (channel) {\n        channel.operating[bullet.mode] = true\n        let i = -1\n        channel.queue[bullet.mode].some((item, index) => {\n          if (item.id === bullet.id) {\n            i = index\n            return true\n          } else {\n            return false\n          }\n        })\n        if (i > -1) {\n          channel.queue[bullet.mode].splice(i, 1)\n        }\n        channel.operating[bullet.mode] = false\n      }\n    }\n    if (bullet.options.loop) {\n      this.danmu.bulletBtn.main.playedData.push(bullet.options)\n    }\n  }\n\n  resizeSync() {\n    this.resize(true)\n  }\n\n  /**\n   * @private\n   */\n  _initChannels() {\n    if (!this.danmu || !this.danmu.config) {\n      return\n    }\n    const self = this\n    const { config } = self.danmu\n    const channelSize = config.channelSize || (/mobile/gi.test(navigator.userAgent) ? 10 : 12)\n    /** @type {number} */\n    let channelCount\n\n    if (config.area) {\n      const { lines, start, end } = config.area\n      if (validAreaLineRule(lines)) {\n        channelCount = lines\n\n        if (self.direction === 'b2t') {\n          self.width = channelCount * channelSize\n        } else {\n          self.height = channelCount * channelSize\n        }\n      } else {\n        if (start >= 0 && end >= start) {\n          const modulus = end - start\n          if (self.direction === 'b2t') {\n            self.width = Math.floor(self.width * modulus)\n          } else {\n            self.height = Math.floor(self.height * modulus)\n          }\n        }\n      }\n    }\n\n    if (!isNumber(channelCount)) {\n      if (self.direction === 'b2t') {\n        channelCount = Math.floor(self.width / channelSize)\n      } else {\n        channelCount = Math.floor(self.height / channelSize)\n      }\n    }\n\n    let channels = []\n    for (let i = 0; i < channelCount; i++) {\n      channels[i] = {\n        id: i,\n        queue: {\n          scroll: [],\n          top: [],\n          bottom: []\n        },\n        operating: {\n          scroll: false,\n          top: false,\n          bottom: false\n        },\n        bookId: {}\n      }\n    }\n\n    return {\n      channelSize,\n      channelCount,\n      channels\n    }\n  }\n\n  resize(sync = false) {\n    this.logger && this.logger.info('resize')\n    let self = this\n    if (self.resizing) {\n      return\n    }\n    self.resizing = true\n\n    function setItem(channels, i) {\n      channels[i] = {\n        id: i,\n        queue: {\n          scroll: [],\n          top: [],\n          bottom: []\n        },\n        operating: {\n          scroll: false,\n          top: false,\n          bottom: false\n        },\n        bookId: {}\n      }\n    }\n\n    function updateChannelsLower(channels, fontSize) {\n      function updateTopScrollQueue(i) {\n        const items = ['scroll', 'top']\n        items.forEach((key_) => {\n          self.channels[i].queue[key_].forEach((item) => {\n            if (item.el) {\n              channels[i].queue[key_].push(item)\n            }\n          })\n        })\n      }\n      function updateBottomQueue(i) {\n        self.channels[i].queue['bottom'].forEach((item) => {\n          if (item.el) {\n            channels[i + channels.length - self.channels.length].queue['bottom'].push(item)\n            if (item.channel_id[0] + item.channel_id[1] - 1 === i) {\n              let channel_id = [].concat(item.channel_id)\n              item.channel_id = [channel_id[0] - self.channels.length + channels.length, channel_id[1]]\n              item.top = item.channel_id[0] * fontSize\n              if (self.danmu.config.area && self.danmu.config.area.start) {\n                item.top += self.containerHeight * self.danmu.config.area.start\n              }\n              item.topInit()\n            }\n          }\n        })\n      }\n\n      for (let i = 0; i < self.channels.length; i++) {\n        setItem(channels, i)\n        updateTopScrollQueue(i)\n        updateBottomQueue(i)\n      }\n\n      for (let i = 0; i < channels.length; i++) {\n        const items = ['scroll', 'top', 'bottom']\n        items.forEach((key) => {\n          channels[i].queue[key].forEach((item) => {\n            item.resized = false\n          })\n        })\n      }\n      self.channels = channels\n      if (self.direction === 'b2t') {\n        self.channelWidth = fontSize\n      } else {\n        self.channelHeight = fontSize\n      }\n    }\n\n    function updateChannelsGreater(channels, fontSize) {\n      const items = ['scroll', 'top', 'bottom']\n\n      for (let i = 0; i < channels.length; i++) {\n        setItem(channels, i)\n\n        items.forEach((key) => {\n          if (key === 'top' && i > Math.floor(channels.length / 2)) {\n            //\n          } else if (key === 'bottom' && i <= Math.floor(channels.length / 2)) {\n            //\n          } else {\n            let num = key === 'bottom' ? i - channels.length + self.channels.length : i\n            self.channels[num].queue[key].forEach((item, index) => {\n              if (!item.el) {\n                return\n              }\n              channels[i].queue[key].push(item)\n              if (key === 'bottom') {\n                if (item.channel_id[0] + item.channel_id[1] - 1 === num) {\n                  let channel_id = [].concat(item.channel_id)\n                  item.channel_id = [channel_id[0] - self.channels.length + channels.length, channel_id[1]]\n                  item.top = item.channel_id[0] * fontSize\n                  if (self.danmu.config.area && self.danmu.config.area.start) {\n                    item.top += self.containerHeight * self.danmu.config.area.start\n                  }\n                  item.topInit()\n                }\n              }\n              self.channels[num].queue[key].splice(index, 1)\n            })\n          }\n        })\n      }\n      for (let i = 0; i < channels.length; i++) {\n        items.forEach((key) => {\n          channels[i].queue[key].forEach((item) => {\n            item.resized = false\n          })\n        })\n      }\n      self.channels = channels\n\n      if (self.direction === 'b2t') {\n        self.channelWidth = fontSize\n      } else {\n        self.channelHeight = fontSize\n      }\n    }\n\n    function layout() {\n      const { container, bulletBtn } = self.danmu\n\n      self.container = container\n      self.updatePos()\n      self._cancelResizeTimer()\n\n      if (bulletBtn.main.data) {\n        bulletBtn.main.data.forEach((item) => {\n          if (item.bookChannelId) {\n            delete item['bookChannelId']\n            self.logger && self.logger.info('resize导致' + item.id + '号优先弹幕预定取消')\n          }\n        })\n      }\n      self.logger && self.logger.info('resize导致所有轨道恢复正常使用')\n      self.width = self.containerWidth\n      self.height = self.containerHeight\n\n      const { channelSize, channels } = self._initChannels()\n\n      if (self.channels) {\n        if (self.channels.length <= channels.length) {\n          updateChannelsLower(channels, channelSize)\n        } else {\n          updateChannelsGreater(channels, channelSize)\n        }\n      }\n      self.resizing = false\n    }\n\n    if (sync) {\n      layout()\n    } else {\n      this._cancelResizeTimer()\n      this.resizeId = requestAnimationFrame(layout)\n    }\n  }\n\n  /**\n   * @private\n   */\n  _cancelResizeTimer() {\n    if (this.resizeId) {\n      cancelAnimationFrame(this.resizeId)\n      this.resizeId = null\n    }\n  }\n}\n\nexport default Channel\n","export function validAreaLineRule(line) {\n  return typeof line === 'number' && line >= 0 && Number.isInteger(line)\n}\n","import { hasOwnProperty, styleUtil } from './utils/util'\n\nexport default class RecyclableDOMList {\n  constructor(options) {\n    options = {\n      initDOM: () => document.createElement('div'),\n      initSize: 10\n    }\n    this.init(options)\n  }\n\n  init(options) {\n    this.idleList = []\n    this.usingList = []\n    this._id = 0\n    this.options = options\n    this._expand(options.initSize)\n  }\n\n  use() {\n    if (!this.idleList.length) {\n      this._expand(1)\n    }\n    const firseIdle = this.idleList.shift()\n    this.usingList.push(firseIdle)\n    return firseIdle\n  }\n\n  unused(dom) {\n    const idx = this.usingList.indexOf(dom)\n    if (idx < 0) {\n      return\n    }\n    this.usingList.splice(idx, 1)\n    dom.style.opacity = 0\n    this.idleList.push(dom)\n  }\n\n  _expand(size) {\n    for (let i = 0; i < size; i++) {\n      this.idleList.push(this.options.initDOM(this._id++))\n    }\n  }\n\n  destroy() {\n    for (let i = 0; i < this.idleList.length; i++) {\n      this.idleList[i].innerHTML = ''\n      this.idleList[i].textcontent = ''\n      this.clearElementStyle(this.idleList[i])\n    }\n    for (let i = 0; i < this.usingList.length; i++) {\n      this.usingList[i].innerHTML = ''\n      this.usingList[i].textcontent = ''\n      this.clearElementStyle(this.usingList[i])\n    }\n    for (let k in this) {\n      if (hasOwnProperty.call(this, k)) {\n        delete this[k]\n      }\n    }\n  }\n\n  clearElementStyle(element) {\n    const ua = typeof window !== 'undefined' ? window.navigator.userAgent : null\n    if (!ua) {\n      return\n    }\n    if (ua.indexOf('MSIE ') > -1 || ua.indexOf('Trident/') > -1) {\n      styleUtil(element, 'transform', 'none')\n    } else {\n      element.setAttribute('style', '')\n    }\n  }\n}\n","import { throttle } from './utils/util'\n\nclass ResizeObserver {\n  constructor() {\n    this.__handlers = []\n    if (!window.ResizeObserver) {\n      return\n    }\n    try {\n      this.observer = new window.ResizeObserver(\n        throttle((entries) => {\n          this.__trigger(entries)\n        }, 100)\n      )\n      // eslint-disable-next-line no-empty\n    } catch (err) {}\n  }\n\n  addObserver(target, handler) {\n    if (!this.observer || !target) {\n      return\n    }\n    this.observer && this.observer.observe(target)\n    const { __handlers } = this\n    let index = -1\n    for (let i = 0; i < __handlers.length; i++) {\n      if (__handlers[i] && target === __handlers[i].target) {\n        index = i\n      }\n    }\n    if (index > -1) {\n      this.__handlers[index].handler.push(handler)\n    } else {\n      this.__handlers.push({\n        target,\n        handler: [handler]\n      })\n    }\n  }\n\n  unObserver(target) {\n    if (!target) {\n      return\n    }\n    let i = -1\n    this.__handlers.map((item, index) => {\n      if (target === item.target) {\n        i = index\n      }\n    })\n    this.observer && this.observer.unobserve(target)\n    i > -1 && this.__handlers.splice(i, 1)\n  }\n\n  destroyObserver() {\n    this.observer && this.observer.disconnect()\n    this.observer = null\n    this.__handlers = null\n  }\n\n  __runHandler(target) {\n    const { __handlers } = this\n    for (let i = 0; i < __handlers.length; i++) {\n      if (__handlers[i] && target === __handlers[i].target) {\n        __handlers[i].handler &&\n          __handlers[i].handler.map((handler) => {\n            try {\n              handler()\n            } catch (error) {\n              console.error(error)\n            }\n          })\n        break\n      }\n    }\n  }\n\n  __trigger(entries) {\n    entries.map((item) => {\n      this.__runHandler(item.target)\n    })\n  }\n}\n\nconst resizeObserver = new ResizeObserver()\n\nfunction addObserver(target, handler) {\n  resizeObserver.addObserver(target, handler)\n}\n\nfunction unObserver(target, handler) {\n  resizeObserver.unObserver(target, handler)\n}\n\nfunction destroyObserver(target, handler) {\n  resizeObserver.destroyObserver(target, handler)\n}\n\nexport { addObserver, unObserver, destroyObserver }\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#fff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n"],"sourceRoot":""}