!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VContextmenu={},e.Vue)}(this,(function(e,t){"use strict";var n=function(e,n){var o,u=n.arg;if(u){var i=n.value,l=t.isRef(u)?u.value:null===(o=n.instance)||void 0===o?void 0:o.$refs[u];l?"function"==typeof l.addReference?(e.$contextmenuKey=u,l.addReference(e,i)):console.error("".concat(u," 对应的实例不是 VContextmenu")):console.error("没有找到 ".concat(u," 对应的实例"))}else console.error("参数有误")},o=function(e,n){var o,u=e.$contextmenuKey;if(u){var i=t.isRef(u)?u.value:null===(o=n.instance)||void 0===o?void 0:o.$refs[u];i?"function"==typeof i.removeReference?i.removeReference(e):console.error("".concat(u," 对应的实例不是 VContextmenu")):console.error("没有找到 ".concat(u," 对应的实例"))}},u={mounted:n,updated:function(e,t){o(e,t),n(e,t)},beforeUnmount:o},i="v-contextmenu",l="v-contextmenu-icon",r="v-contextmenu-inner",a="v-contextmenu-divider",c="v-contextmenu-item",s="v-contextmenu-item--hover",d="v-contextmenu-item--disabled",m="v-contextmenu-group",v="v-contextmenu-group__title",f="v-contextmenu-group__menus",p="v-contextmenu-submenu",h="v-contextmenu-submenu__title",x="v-contextmenu-submenu__menus",g="v-contextmenu-submenu__menus--top",b="v-contextmenu-submenu__menus--right",C="v-contextmenu-submenu__menus--bottom",y="v-contextmenu-submenu__menus--left",w="v-contextmenu-submenu__arrow";var V=["contextmenu"],_=t.defineComponent({name:"VContextmenu",props:{modelValue:{type:Boolean,default:!1},autoAdjustPlacement:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},teleport:{type:[String,Object],default:function(){return"body"}},preventContextmenu:{type:Boolean,default:!0}},emits:["show","hide","update:modelValue","contextmenu"],setup:function(e,n){var o=n.emit,u=t.ref(null),i=t.ref(e.modelValue||!1),l=function(e){i.value=e,o("update:modelValue",e)},r=t.ref({top:0,left:0}),a=t.computed((function(){return{top:"".concat(r.value.top,"px"),left:"".concat(r.value.left,"px")}})),c=t.ref(null),s=function(n,i){var a,c,s=n instanceof Event?i:n,d=(null==s?void 0:s.autoAdjustPlacement)||e.autoAdjustPlacement,m={top:(null==s?void 0:s.top)||0,left:(null==s?void 0:s.left)||0};n instanceof Event&&(n.preventDefault(),m.top=null!==(a=null==s?void 0:s.top)&&void 0!==a?a:n.pageY,m.left=null!==(c=null==s?void 0:s.left)&&void 0!==c?c:n.pageX);l(!0),t.nextTick((function(){if(d){var e=u.value;if(!e)return;var t=e.clientWidth,n=e.clientHeight;if(n+m.top>=window.innerHeight+window.scrollY){var i=m.top-n;i>window.scrollY&&(m.top=i)}if(t+m.left>=window.innerWidth+window.scrollX){var l=m.left-t;l>window.scrollX&&(m.left=l)}}r.value=m,o("show")}))},d=function(){c.value=null,l(!1),o("hide")},m=t.reactive(new Map),v=t.ref(),f=t.computed((function(){return v.value&&m.get(v.value)})),p=function(e){e.target&&u.value&&v.value&&(u.value.contains(e.target)||f.value&&f.value.triggers.includes("click")&&v.value.contains(e.target)||l(!1))};return t.watch(i,(function(e){e?document.addEventListener("click",p):document.removeEventListener("click",p)})),t.onBeforeUnmount((function(){document.removeEventListener("click",p)})),t.provide("visible",i),t.provide("autoAdjustPlacement",e.autoAdjustPlacement),t.provide("show",s),t.provide("hide",d),{visible:i,style:a,currentReferenceOptions:f,currentOptions:c,contextmenuRef:u,addReference:function(t,n){var o=null!=n&&n.trigger?Array.isArray(n.trigger)?n.trigger:[n.trigger]:V,u=function(n){e.disabled||(v.value=t,s(n,{}))};o.forEach((function(e){t.addEventListener(e,u)})),m.set(t,{triggers:o,handler:u})},removeReference:function(e){var t=m.get(e);t&&(t.triggers.forEach((function(n){e.removeEventListener(n,t.handler)})),m.delete(e))},toggle:l,show:s,hide:d}},methods:{renderContent:function(){var e,n,o=this;return t.withDirectives(t.createVNode("div",{class:i,ref:"contextmenuRef",style:this.style,onContextmenu:function(e){o.$props.preventContextmenu&&e.preventDefault(),o.$emit("contextmenu",e)}},[t.createVNode("ul",{class:r},[null===(e=(n=this.$slots).default)||void 0===e?void 0:e.call(n,{triggerOptions:"currentReferenceOptions",options:"currentOptions"})])]),[[t.vShow,"visible"]])}},render:function(){var e,n;return this.visible?this.teleport?t.createVNode(t.Teleport,{to:this.teleport},"function"==typeof(n=e=this.renderContent())||"[object Object]"===Object.prototype.toString.call(n)&&!t.isVNode(n)?e:{default:function(){return[e]}}):this.renderContent():null}});function N(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function j(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=t.defineComponent({name:"VContextmenuItem",props:{disabled:{type:Boolean,default:!1},hideOnClick:{type:Boolean,default:!0},contextmenuAsClick:{type:Boolean,default:!0}},emits:["click","contextmenu","mouseenter","mouseleave"],setup:function(e,n){var o=n.emit,u=t.inject("hide"),i=t.ref(!1);return{classes:t.computed((function(){return j(j(j({},c,!0),d,e.disabled),s,i.value)})),handleClick:function(t){o("click",t),e.disabled||e.hideOnClick&&(null==u||u())},handleContextmenu:function(t){if(o("contextmenu",t),e.contextmenuAsClick){if(e.disabled)return;e.hideOnClick&&(null==u||u())}},handleMouseenter:function(t){o("mouseenter",t),e.disabled||(i.value=!0)},handleMouseleave:function(t){o("mouseleave",t),e.disabled||(i.value=!1)}}},render:function(){var e,n;return t.createVNode("li",{class:this.classes,onClick:this.handleClick,onContextmenu:this.handleContextmenu,onMouseenter:this.handleMouseenter,onMouseleave:this.handleMouseleave},[null===(e=(n=this.$slots).default)||void 0===e?void 0:e.call(n)])}}),R=t.defineComponent({name:"VContextmenuDivider",render:function(){return t.createVNode("li",{class:a},null)}}),M=t.defineComponent({name:"VContextmenuIcon",props:{name:{type:String,required:!0}},render:function(){return t.createVNode("i",{class:[l,"".concat(l,"-").concat(this.name)]},null)}}),O=t.defineComponent({name:"VContextmenuSubmenu",props:{title:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["mouseenter","mouseleave"],setup:function(e,n){var o=n.emit,u=t.ref(null),l=t.inject("autoAdjustPlacement"),r=t.ref(["top","right"]),a=t.ref(!1),m=t.computed((function(){return j(j(j(j({},c,!0),h,!0),s,a.value),d,e.disabled)})),v=t.computed((function(){return j(j(j(j(j(j({},i,!0),x,!0),g,r.value.includes("top")),b,r.value.includes("right")),C,r.value.includes("bottom")),y,r.value.includes("left"))}));return{hover:a,submenuRef:u,titleClasses:m,menusClasses:v,handleMouseenter:function(n){e.disabled||(a.value=!0,o("mouseenter",n),t.nextTick((function(){var e=[];if(l){var t=n.target.getBoundingClientRect();if(!u.value)return;var o=u.value.clientWidth,i=u.value.clientHeight;t.right+o>=window.innerWidth?e.push("left"):e.push("right"),t.bottom+i>=window.innerHeight?e.push("bottom"):e.push("top")}r.value=e})))},handleMouseleave:function(t){e.disabled||(a.value=!1,o("mouseleave",t))}}},render:function(){var e,n,o,u;return t.createVNode("li",{class:p,onMouseenter:this.handleMouseenter,onMouseleave:this.handleMouseleave},[t.createVNode("div",{class:this.titleClasses},[(null===(e=(n=this.$slots).title)||void 0===e?void 0:e.call(n))||this.title,t.createVNode("span",{class:w},[t.createVNode(M,{name:"right-arrow"},null)])]),this.hover?t.createVNode("div",{ref:"submenuRef",class:this.menusClasses},[t.createVNode("ul",{class:r},[null===(o=(u=this.$slots).default)||void 0===o?void 0:o.call(u)])]):null])}}),S=t.defineComponent({name:"VContextmenuGroup",props:{title:{type:String,default:void 0},maxWidth:{type:[Number,String],default:void 0}},setup:function(e){return{style:t.computed((function(){if(e.maxWidth)return{"max-width":"number"==typeof e.maxWidth?"".concat(e.maxWidth,"px"):e.maxWidth,"overflow-x":"auto"}}))}},methods:{renderTitle:function(){var e,n,o=(null===(e=(n=this.$slots).title)||void 0===e?void 0:e.call(n))||this.title;return o?t.createVNode("div",{class:v},[o]):null}},render:function(){var e,n;return t.createVNode("li",{class:m},[this.renderTitle(),t.createVNode("ul",{style:this.style,class:f},[null===(e=(n=this.$slots).default)||void 0===e?void 0:e.call(n)])])}}),$="3.2.0",A=function(e){e.directive("contextmenu",u),e.component(_.name,_),e.component(k.name,k),e.component(R.name,R),e.component(O.name,O),e.component(S.name,S)},B={install:A,version:$};e.Contextmenu=_,e.ContextmenuDivider=R,e.ContextmenuGroup=S,e.ContextmenuItem=k,e.ContextmenuSubmenu=O,e.default=B,e.directive=u,e.install=A,e.version=$,Object.defineProperty(e,"__esModule",{value:!0})}));
