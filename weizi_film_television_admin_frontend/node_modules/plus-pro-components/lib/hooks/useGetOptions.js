'use strict';

var vue = require('vue');
require('../components/utils/index.js');
var is = require('../components/utils/is.js');

const throwError = (data) => {
  if (!is.isArray(data)) {
    console.error("Uncaught TypeError: ", `options expected Array but got ${is.toRawType(data)}`);
  }
};
const useGetOptions = (props) => {
  const options = vue.ref([]);
  if (!props.options) {
    options.value = [];
  } else if (vue.isRef(props.options)) {
    vue.watch(
      props.options,
      (val) => {
        options.value = val;
      },
      {
        immediate: true
      }
    );
  } else if (is.isArray(props.options)) {
    options.value = [...props.options];
  } else if (is.isFunction(props.options)) {
    const getValue = props.options;
    const result = getValue(props);
    if (is.isPromise(result)) {
      ;
      result.then((res) => {
        options.value = res;
        throwError(options.value);
      }).catch((err) => {
        throw err;
      });
    } else {
      options.value = result;
    }
  } else if (is.isPromise(props.options)) {
    const getValue = props.options;
    getValue.then((res) => {
      options.value = res;
      throwError(options.value);
    }).catch((err) => {
      throw err;
    });
  } else {
    throwError(props.options);
  }
  return options;
};

exports.useGetOptions = useGetOptions;
